<span  style="font-family: Simsun,serif; font-size: 17px; ">

[TOC]

### 什么是断路器

- 当一个服务调用另一个服务，由于网络原因或者自身原因，调用者就会等待被调用者的相应
- 如果有更多的服务请求到这些资源导致更多的请求等待，就会发生连锁效应，雪崩
- 三种状态
  - 打开状态: 一段时间内，达到一定的次数无法调用,并且多次检测没有恢复的迹象，断路器完全打开，下次就不会请求到该服务
  - 半开状态: 短时间内 有恢复迹象,断路器会将部分请求发给该服务,正常调用时，断路器关闭
  - 关闭状态: 服务一直处于正常状态，能正常调用

### 什么是Hystrix

- Hystrix四中防雪崩方式
  - 服务降级: 防止客户端等待,调用失败就调用本地的方法返回一个友好提示给客户端
  - 服务熔断: 单位时间诶，请求数量到达指定值，或者错误到达阈值，开启熔断,接口调用失败就会进入调用接口提前定义好的一个熔断方法，返回错误信息
  - 服务隔离: 隔离服务之间互相影响,为隔离的服务开启一个独立的线程池，这样在高并发的情况下也不会影响其他的服务。
  - 服务监控: 在服务发生调用时，会将每秒请求数,成功请求等运行指标记录下来

- 服务降级如何实现
~~~
重写 getFallback()方法
当Hystrix run方法或者construct执行发生错误时执行getFallback()方法
~~~

### 谈谈雪崩效应

- 雪崩效应实在大型互联网项目中,当某个服务发生宕机是，调用者的服务器也会发生宕机
- 大型项目的微服务之间是互通的，这样就会降服务的不可用扩大到各个其他服务中，从而使整个项目的服务器宕机崩溃
  - 原因: 某个服务器的代码存在bug
  - 请求访问量激增导致服务器发生崩溃，例如抢红包，秒杀功能
  - 服务器硬件故障

### 如何保护服务

- 使用Hystrix服务降级能有效为不同的服务分配资源
- 一旦服务不可用，则返回友好提示，不占用其他服务资源，
- 从而避免单个服务器崩溃应发整体的不可用

### 

### del

- Hystrix 是一个延迟和容错库，旨在隔离远程系统，服务和第三方库的访问点，当出现故障是不可避免的故障时，停止级联故障并在复杂的
分布式系统中实现弹性
- 我们将使用 Hystrix 在这种情况下的 Fallback 方法功能
- 提供一些默认值

</span>