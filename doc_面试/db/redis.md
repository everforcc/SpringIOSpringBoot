<font face="Simsun" size=3>

~~~
String
List
set
~~~

- 持久化

~~~
Rdb
Rdb是redis DataBase缩写功能核心函数rdbSave（生成rdb文件）和rdbLoad（从文件加载内存）两个函数。

Aof是append-only file缩写
每当执行服务器（定时）任务或者函数flushAppendOnlyFile函数都会被调用，这个函数执行以下两个工作。

Rdb与Aof对比
1、aof文件比rdb更新频率高，优先使用aof还原数据。
2、Aof比rdb更安全也更大
3、Rdb性能比aof好
4、如果两个都配置了优先加载aof
~~~

---

~~~
主从
    

哨兵
    主从模式，切换需要时间丢数据，没办法解决master写的压力

集群(直连)
    1、资源隔离型较差，容易出现相互影响的情况。
    2、数据通过异步复制，不保证数据的一致性。

~~~


## 什么是缓存穿透？如何避免？什么是缓存雪崩？如何避免？

~~~
缓存穿透：
一般的缓存系统，都是按照key去缓存查询，如果不存在对应的value值，就应该去后端系统查询（比如DB）。一些恶意的请求会故意查询不存在的key，请求量很大，就会对后台系统造成很大的压力。这就叫缓存穿透。
如何避免：
1、对查询结果为空的情况下也进行缓存，缓存时间设置短一点，或者该key对应的数insert了之后清理缓存。
2、对一定不存在的key值进行过滤。可以把所有的可能存在的key放到一个大的bitmap中，查询是通过bitmap过滤。
缓存雪崩：
当缓存服务器重启或者缓存集中在某一个时间段失效，这样在失效的时候，会给后端系统带来很大的压力。导致系统崩溃。
如何避免：
1、在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对某个key只允许一个线程查询和写缓存，其他线程等待。
2、做二级缓存，a1为原始缓存，a2为拷贝缓存，a1失效时，可以访问a2，a1缓存时间设置短期，a2设置为长期。
3、不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。
~~~

</font>